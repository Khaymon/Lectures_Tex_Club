\subsection{Свободные абелевы группы}

В данном разделе и далее рассматриваемые группы будут абелевыми, и операция в них будет обозначаться через $+$.

\begin{example}
	Группа $\Q$ не является конечнопорожденной. Она не является циклической, и любые две нетривиальных подгруппы в ней имеют нетривиальное пересечение.
\end{example}

\begin{note}
	Если $(n, k) = 1$, то $\Z_n \oplus \Z_k \cong \Z_{nk}$, поскольку $\ord(\overline{1}, \overline{1})$ в этой группе равен $nk$.
\end{note}

\begin{definition}
	Пусть $G$ "--- абелева группа. Система элементов $(e_1, \dotsc, e_k)$ группы $G$ называется \textit{независимой}, если $\forall n_1, \dotsc, n_k \in \Z: \sum_{i = 1}^kn_ie_i = 0 \ra n_1 = \dotsb = n_k = 0$. Система $(e_1, \dotsc, e_k)$ называется \textit{базисом} в $G$, если она независима и $G = \gl e_1, \dotsc, e_k\gr$.
\end{definition}

\begin{note}
	Любая непустая система в $\Z_n$ зависима.
\end{note}

\begin{proposition}
	Пусть $(e_1, \dotsc, e_k)$ "--- базис в абелевой группе $G$. Тогда $\forall g \in G: \exists! n_1, \dotsc, n_k \in \Z: g = \sum_{i = 1}^kn_ie_i$.
\end{proposition}

\begin{proof}
	Существование коэффициентов $n_1, \dotsc, n_k$ следует из определения базиса. Если же $g = \sum_{i = 1}^kn_ie_i = \sum_{i = 1}^km_ie_i$, то $\sum_{i = 1}^k(n_i - m_i)e_i = 0$, откуда $\forall i \in \{1, \dotsc, k\}: n_i \hm= m_i$.
\end{proof}

\begin{definition}
	Абелева группа $G$ называется \textit{свободной абелевой группой ранга $k$}, если в ней существует базис из $k$ элементов.
\end{definition}

\begin{proposition}
	Пусть $G$ "--- свободная абелева группа ранга $k$. Тогда $G \cong \Z^k$.
\end{proposition}

\begin{proof}
	Пусть $(e_1, \dotsc, e_k)$ "--- базис в $G$. Рассмотрим отображение $\phi: \Z^k \to G$ такое, что $\forall (n_1, \dotsc, n_k) \in \Z^k: \phi((n_1, \dotsc, n_k)) \hm= \sum_{i = 1}^kn_ie_i$. Очевидно, это гомоморфизм, причем биективный в силу предыдущего утверждения.
\end{proof}

\begin{note}
	Группа $\Z^k$ обладает базисом. Например, им является система $e_1 \hm= (1, 0, \dotsc, 0), \dotsc, e_k = (0, \dotsc, 0, 1)$.
\end{note}

\begin{proposition}[Универсальное свойство свободной абелевой группы]
	Пусть $G$ "--- свободная абелева группа с базисом $(e_1, \dotsc, e_n)$. Тогда для любой абелевой группы $A$ выполнено, что $\forall a_1, \dotsc, a_n \in A: \exists \phi: G \to A$ "--- гомоморфизм: $\forall i \in \{1, \dotsc, n\}: \phi(e_i) = a_i$.
\end{proposition}

\begin{proof}
	Отображение $\phi$ задается однозначно: $\forall g \in G, g \hm= \sum_{i = 1}^nk_ie_i: \phi(g) \hm= \sum_{i = 1}^nk_ia_i$. Определение корректно в силу единственности разложения каждого элемента по базису. Остается проверить, что полученное отображение действительно является гомоморфизмом: $\forall g, h \in G, g = \sum_{i = 1}^nk_ie_i, h = \sum_{i = 1}^nl_ie_i: \phi(g) + \phi(h) \hm= \sum_{i = 1}^nk_ia_i + \sum_{i = 1}^nl_ia_i \hm= \sum_{i = 1}^n(k_i + l_i)a_i = \phi(g + h)$.
\end{proof}

\begin{proposition}
	Пусть $G$ "--- свободная абелева группа с базисом $(e_1, \dotsc, e_n)$. Тогда:
	\[G \cong \gl a_1, \dotsc, a_n \mid \forall i, j \in \{1, \dotsc, n\}: [a_i, a_j] = e \gr \cong F_n / F_n'\]
\end{proposition}

\begin{proof}
	Положим $H := \gl a_1, \dotsc, a_n \mid \forall i, j \in \{1, \dotsc, n\}: [a_i, a_j] = e \gr$. Группа $H$ "--- абелева, поскольку все ее порождающие коммутируют. Тогда, по универсальному свойству $G$, существует гомоморфизм $\phi: G \to H$ такой, что $\forall i \in \{1, \dotsc, n\}: \phi(e_i) = a_i$. Поскольку $G$ "--- абелева, то соотношения, задающие $H$, выполнены и в $G$, и, по универсальному свойству $H$, существует гомоморфизм $\psi: H \to G$ такой, что $\forall i \in \{1, \dotsc, n\}: \psi(a_i) = e_i$. Остается заметить, что $\phi \circ \psi = \id_H$, $\psi \circ \phi = \id_G$, поэтому этим гомоморфизмы биективны и взаимно обратны. Наконец, по определению группы, заданной образующими и соотношениями, $H \cong F_n / \gl [a_i, a_j] : i, j \hm\in \{1, \dotsc, n\}\gr_{norm} \cong F_n / F_n'.$
\end{proof}

\begin{note}
	Изоморфизмы в утверждении выше имеют следующий вид: $e_i \mapsto a_i \mapsto \overline{f_i} \hm= f_iF_n'$.
\end{note}

\begin{theorem}
	Пусть $G$ "--- свободная абелева группа, $(e_1, \dotsc, e_n)$ и $(e_1', \dotsc, e_k')$ "--- два базиса в $G$. Тогда $n = k$.
\end{theorem}

\begin{proof}
	Пусть без ограничения общности $n < k$. Поскольку $(e_1, \dotsc, e_n)$ "--- базис, то $(e_1', \dotsc, e_k') \hm= (e_1, \dotsc, e_n)S$ для некоторой матрицы $S \in M_{n \times k}(\Z) \subset M_{n \times k}(\Q)$. По основной лемме о линейной зависимости, столбцы $S$ линейно зависимы над $\Q$: $\exists \overline{q} \in \Q^k, \overline{q} \ne \overline{0}: S\overline{q} = \overline{0}$. Можно считать, что $\overline{q} \in \Z^k$, поскольку умножение всех элементов столбца на наименьшее общее кратное их знаменателей сохраняет равенство. Но тогда $(e_1', \dotsc, e_k')\overline{q} = 0$, то есть система $(e_1', \dotsc, e_k')$ зависима --- противоречие.
\end{proof}

\begin{definition}
	Пусть $G$ "--- свободная абелева группа. Ее \textit{рангом} называется число элементов в любом базисе в $G$.
\end{definition}

\begin{note}
	Мы доказали, что любая система из $n+1$ элемента в свободной абелевой группе ранга $n$ зависима, но из этого не следует, что один из элементов такой системы выражается через остальные. Например, система $(2, 3)$ в $\Z$ зависима, но 2 и 3 не выражаются друг через друга.
\end{note}

\begin{theorem}
	Пусть $G$ "--- свободная абелева группа, $(e_1, \dotsc, e_n)$ "--- базис в $G$. Рассмотрим $(e_1', \dotsc, e_n') = (e_1, \dotsc, e_n)S$, $S \in M_n(\Z)$. Тогда $(e_1', \dotsc, e_n')$ "--- базис в $G$ $\lra$ $\det{S} = \pm1$.
\end{theorem}

\begin{proof}~
	\begin{itemize}
		\item[$\ra$] Если $(e_1', \dotsc, e_n')$ "--- базис в $G$, то  $(e_1, \dotsc, e_n) = (e_1', \dotsc, e_n')T \hm= (e_1, \dotsc, e_n)ST$, $T \hm\in M_n(\Z)$. В силу единственности разложения, $ST = E$, тогда, поскольку определители $S$ и $T$ целочисленны, $|\det{S}| = |\det{T}| = 1$.
		
		\item[$\la$] Если $\det{S} = \pm1$, то, по формуле Крамера, $S^{-1} \in M_n(\Z)$. Тогда $(e_1, \dotsc, e_n) \hm= (e_1', \dotsc, e_n')S^{-1}$, поэтому $G \hm= \gl e_1', \dotsc, e_n' \gr$. Наконец, система $(e_1', \dotsc, e_n')$ независима: если для некоторого $\overline{z} \in \Z^n$ $(e_1', \dotsc, e_n')\overline{z} = 0$, то тогда $(e_1, \dotsc, e_n)S\overline{z} = 0$, откуда $S\overline{z} = \overline{0}$, и, в силу невырожденности $S$, $\overline{z} = \overline{0}$.
	\end{itemize}
\end{proof}

\begin{note}
	В ходе доказательства теоремы мы также получили, что $(M_n(\Z))^* = \{S \hm\in M_n(\Z): \det{S} = \pm1\}$. Эта группа обозначается через $\GL_n(\Z)$.
\end{note}

\begin{note}
	Для любой абелевой группы $A = \gl a_1, \dotsc, a_n \gr$ существует гомоморфизм $\phi: \Z^n \to A$ такой, что $\forall i \in \{1, \dotsc, n\}: \phi(e_i) \hm= a_i$. Этот гомоморфизм сюръективен, тогда, по основной теореме о гомоморфизме, $A \cong \Z^n / \ke\phi$.
\end{note}

\begin{theorem}
	Пусть $G$ "--- свободная абелева группа ранга $n$, $H \le G$. Тогда $H$ "--- свободная абелева группа ранга $k$, $k \le n$.
\end{theorem}

\begin{proof}
	Проведем индукцию по $n$. База, $n = 0$, тривиальна, поскольку в этом случае $G = H =  \{e\}$.
	
	Пусть теперь $n \ge 1$, $(e_1, \dotsc, e_n)$ "--- базис в $G$. Рассмотрим гомоморфизм $\phi: G \to \Z$ такой, что $\phi(e_n) = 1$, $\forall i \hm\in \{1, \dotsc, n - 1\}: \phi(e_i) = 0$. Тогда $G_1 \hm{:=} \gl e_1, \dotsc, e_{n - 1} \gr = \ke\phi$ "--- свободная абелева группа ранга $n - 1$. Пусть $\psi := \phi|_H$, $H_1 \hm{:=} \ke\psi \hm= G_1 \cap H \le G_1$. По предположению индукции, $H_1$ "--- свободная абелева группа с базисом $(h_1, \dotsc, h_l)$, $l \le n - 1$. Если $\im\psi = \{0\}$, то $H = H_1$. Иначе "--- $\im\psi = m\Z$, $m \ge 1$. Выберем $h_{l + 1}$ из $\psi^{-1}(m)$ и докажем, что $(h_1, \dotsc, h_{l + 1})$ "--- базис в $H$.
	
	С одной стороны, $\forall h \in H: \exists h' \in \ke\psi: h = h' \hm+ \frac{\psi(h)}{m}h_{l + 1}$, поэтому $H \hm= \gl h_1, \dotsc, h_{l + 1} \gr$. С другой стороны, если $\sum_{i = 1}^{l + 1}\alpha_ih_i = 0$, то:
	\[0 = \psi\left(\sum_{i = 1}^{l + 1}\alpha_ih_i\right) = \sum_{i = 1}^{l+1}\alpha_i\psi(h_i) = \alpha_{k+1}m\]
	
	Значит, $\alpha_{l + 1} = 0$. Но тогда, в силу независимости $(h_1, \dotsc, h_l)$, $\alpha_1 = \dotsb = \alpha_l = 0$, и $(h_1, \dotsc, h_{l+1})$ независима.
\end{proof}

\begin{note}[Теорема Нильсена-Шрайера]
	Пусть $F_n$ "--- свободная группа,  $H \le F_n$. Тогда $H$ "--- тоже свободная группа, однако число свободных порождающих в $H$ может превышать $n$ и даже быть бесконечным.
\end{note}

\begin{example}
	Пусть $F_2 = \gl a, b \gr$ "--- свободная группа со свободными образующими $a, b$. Тогда $H = \gl a^kba^k : k \in \N \gr \le F_2$ "--- свободная группа со свободными образующими $a^kba^k$, $k \in \N$.
\end{example}

\begin{note}
	Если $G$"--- свободная абелева группа и $H \le G$ "--- свободная абелева группа того же ранга, что и $G$, то необязательно $H = G$. Например, $2\Z \ne \Z$.
\end{note}

\begin{exercise}
	Рассмотрим линейное пространство $\R^n$ с базисом $(\overline{e_1}, \dotsc, \overline{e_n})$. $\Gamma \hm= \gl \overline{e_1}, \dotsc, \overline{e_n}\gr \le \R^n$ "--- свободная абелева группа, также называемая решеткой. Тогда:
	\begin{enumerate}
		\item Фундаментальный объем, то есть $V(\Gamma) := |V(\overline{e_1}, \dotsc, \overline{e_n})|$, не зависит от выбора базиса в $\Gamma$
		
		\item Если $\Gamma_1 \le \Gamma_2$ "--- две решетки ранга $n$ в $\R^n$, то $|\Gamma_2 : \Gamma_1| = \frac{V(\Gamma_1)}{V(\Gamma_2)}$
	\end{enumerate}
\end{exercise}

\begin{solution}~
	\begin{enumerate}
		\item Пусть $e = (\overline{e_1}, \dotsc, \overline{e_n})$ и $e' = (\overline{e_1'}, \dotsc, \overline{e_n'})$ "--- два базиса в $\Gamma$, $\Gamma(e)$, $\Gamma(e')$ "--- матрицы Грама этих базисов. Если $S$ "--- матрица перехода из $e$ в $e'$, то $|\det{S}| = 1$, поэтому $V(e') \hm= \sqrt{\det\Gamma(e')} \hm= \sqrt{\det{(S^T\Gamma(e)S)}} = \sqrt{\det\Gamma(e)} = V(e)$.
		
		\item Пока нет.
		%Выберем базисы $e' = (\overline{e'_1}, \dotsc, \overline{e'_n})$ и $e'' = (\overline{e''_1}, \dotsc, \overline{e''_n})$ в $\Gamma_1$ и $\Gamma_2$, и пусть $e' = e''T$, $T \in M_n(\Z)$. Положим $d := |\det{T}| \ge 1$, тогда, по формуле Крамера, $dT^{-1} \in M_n(\Z)$.
	\end{enumerate}
\end{solution}

\begin{proposition}
	Пусть $A \in M_{n \times k}(\Z)$. Тогда $\exists P \hm\in \GL_n(\Z): \exists Q \in \GL_k(\Z): \exists D \hm\in M_{n \times k}(\Z)$ "--- матрица с главным минором вида $\diag(u_1, \dotsc, u_{\min(k, n)})$ и нулями на остальных позициях: $A = PDQ$.
\end{proposition}

\begin{solution}
	Будет представлено на следующей лекции.
\end{solution}

\begin{note}
	Представление $A$ в таком виде, как в утверждении выше, называется \textit{нормальной формой Смита}.
\end{note}

\begin{theorem}
	Пусть $G$ "--- свободная абелева группа ранга $n$ и $H \hm\le G$ "--- свободная абелева группа ранга $k \le n$. Тогда в $G$ и $H$ существуют базисы $(g_1, \dotsc, g_n)$ и $(h_1, \dotsc, h_k)$ такие, что $\forall i \in \{1, \dotsc, k\}: h_i = u_ig_i, u_i \in \Z$, причем $u_1\mid \dotsb \mid u_k$.
\end{theorem}

\begin{proof}
	Пусть $(e_1, \dotsc, e_n)$ "--- базис в $G$, $(a_1, \dotsc, a_k)$ "--- базис в $H$. Тогда $(a_1, \dotsc, a_k) = (e_1, \dotsc, e_n)A$, где $A \in M_{n \times k}(\Z)$. Пусть $A \hm= PDQ$ "--- нормальная форма Смита матрицы $A$. Тогда базисы $(g_1, \dotsc, g_n) = (e_1, \dotsc, e_n)P$, $(h_1, \dotsc, h_k) = (a_1, \dotsc, a_k)Q^{-1}$ являются искомыми.
\end{proof}

\begin{note}
	Базисы в $G$ и $H$ из теоремы выше называются \textit{согласованными}.
\end{note}

\begin{corollary}
	Пусть $A$ "--- конечнопорожденная абелева группа. Тогда $A \cong Z^l \oplus \Z_{u_1} \oplus \dots \oplus \Z_{u_k}$, где $l, u_1, \dotsc, u_k \in \Z$, $l \ge 0$, $u_1 \mid \dotsb \mid u_k$.
\end{corollary}

\begin{proof}
	Пусть $A = \gl a_1, \dotsc, a_n \gr$. Тогда $A \cong G / H$, где $G$ "--- свободная абелева группа ранга $n$, $H \le G$ "--- свободная абелева группа ранга $k$. Выберем в $G$ и $H$ согласованные базисы $(g_1, \dotsc, g_n)$ и $(h_1, \dotsc, h_k)$. Заметим теперь, что $G \hm= \gl g_1\gr \oplus \dotsb \oplus \gl g_n\gr$, $H \hm= \gl h_1\gr \oplus \dotsb \oplus \gl h_k\gr$ и, более того, $\forall i \hm\in \{1, \dotsc, k\}: \gl h_i\gr \le \gl g_i\gr$. Тогда, считая, что $h_{k + 1} = \dotsb = h_n = 0$, получим:
	\[A \cong G/ H \cong \bigoplus\limits_{i = 1}^n\gl g_i\gr/\gl h_i\gr \cong \Z_{u_1} \oplus \dotsb \oplus \Z_{u_k} \oplus \Z^{n-k}\]
\end{proof}

\begin{note}
	Возможна ситуация, в которой несколько первых прямых слагаемых в разложении $A$ в доказательстве следствия выше "--- это нулевые подгруппы.
\end{note}