\subsubsection{Унициклические графы}

\begin{Def}
	Граф называется \emph{унициклическим}, если он связен и содержит ровно один цикл.
\end{Def}

\begin{lemma} 
	Число лесов на n вершинах с $r$ деревьями, где i-му дереву принадлежит вершина с номером i, равно 
	$ \mathlarger n^{n-1-r}r$
\end{lemma}\label{forestlemma}

%\begin{proof}
%	Нестрого можно рассуждать так: добавим вершину с номером $ n + 1 $ и посмотрим на всевозмодные 
%\end{proof}


Обозначим за $U(n)$ количество унициклических графов на $n$ вершинах. Докажем, что справедлива формула:

$$
U(n)=\sum_{r=3}^{n} C_{n}^{r} \cdot \frac{(r-1)!}{2} \cdot n^{n-1-r} \cdot r
$$

Неформально можно рассуждать так: выберем произвольное число $r$ ($r \geqslant 3$) и посчитаем количество графов с единственным циклом длины $r$. Мы можем выбрать $C_{n}^{r}$ способами $r$ вершин, участвующих в цикле и соединить их в цикле $\frac{(r-1) !}{2}$ способами. Если выкинуть ребра цикла, то останется лес из $r$
деревьев на $n$ вершинах, где $i$ -ое дерево содержит $v_{i} .$ Таких деревьев по \ref{forestlemma} ровно $n^{n-1-r} r$.

Найдем асимптотику для функции $U(n)$.
\begin{theorem}
	$$U(n) \sim \sqrt{\frac{\pi}{8}} n^{n-\frac{1}{2}}$$
\end{theorem} \label{izvrat}

\begin{proof}
	$$
	\begin{aligned}
	U(n) &=\sum_{r=3}^{n} C_{n}^{r} \frac{(r-1) !}{2} n^{n-1-r} r \\
	&=\frac{1}{2} n^{n-1} \sum_{r=3}^{n} n^{-r} \prod_{i = 1}^{r-1}\left(n-i\right) \\
	&=\frac{1}{2} n^{n-1} \sum_{r=3}^{n} \prod_{i = 1}^{r-1}\left(1-\frac{i}{n}\right)
	\end{aligned}
	$$
	Рассмотрим отдельно $\sum_{r=3}^{n}\left(1-\frac{1}{n}\right) \ldots\left(1-\frac{r-1}{n}\right)$. По формуле, использовавшейся в процессе доказательства \ref{exponent}, имеем:
	
	$$
	\sum_{i = 1}^{n} \ln\left(1 - \frac{i}{n}\right)  = -\frac{r(r-1)}{2n} + O\left( \frac{r^3}{n^2}\right) 
	$$
	
	\qquad
	
	Заметим, что при $r>\sqrt{n}$ дробь $\mathlarger{-\frac{r(r-1)}{2 n} \rightarrow-\infty} \Rightarrow e^{\frac{-r(r-1)}{2 n}} \rightarrow 0
	$, при $r<n^{\frac{2}{3}}: O\left(\frac{r^{3}}{n^{2}}\right)=o(1) .$ Тогда имеем
	
	
	\begin{equation*}
	\mathlarger{
	\sum_{r=3}^{n}\prod_{i = 1}^{r-1}\left(1-\frac{i}{n}\right)=} \\
 	\underbrace{\mathlarger{\sum_{r=3}^{\left[n^{0.6}\right]}\prod_{i = 1}^{r-1}\left(1-\frac{i}{n}\right)}}_{S_1}+\underbrace{\mathlarger{\sum_{r=\left[n^{0.6}\right]+1}^{n}\prod_{i = 1}^{r-1}\left(1-\frac{i}{n}\right)}}_{S_2} \footnote{Константа 0.6 взята, поскольу она близка к числу 2/3.}
	\end{equation*}

	Оценим $S_{2}:$
	$$
	\begin{aligned}
		S_{2} \leqslant & \sum_{r=\left[n^{0.6}\right]+1}^{n} e^{-\frac{r(r-1)}{2 n}}  \\
		\leqslant & \sum_{r=\left[n^{0.6}\right]+1}^{n} e^{-\frac{n^{0,6}\left(n^{0,6}-1\right)}{2 n}} \\
		=& \sum_{r=\left[n^{0.6}\right]+1}^{n} e^{-\frac{n^{0,2}(1+o(1))}{2}} < \\
		<& n e^{-\frac{n^{0,2}(1+o(1))}{2}} \rightarrow 0 
	\end{aligned} \label{S_2}
	$$
	
	Теперь оценим $S_{1}$:
	
	\begin{equation*}
	\begin{aligned}
	S_{1} & \sim \sum_{r=3}^{\left[n^{0.6}\right]} e^{-\frac{r(r-1)}{2 n}+O\left(\frac{r^{3}}{n^{2}}\right)} \\
	& \sim \sum_{r=3}^{\left[n^{0.6}\right]} e^{-\frac{r(r-1)}{2 n}} \\
	& \sim \sum_{r=3}^{\left[n^{0.6}\right]} e^{-\frac{r^{2}}{2 n}} \\
	&=\sum_{r=0}^{\infty} e^{-\frac{r^{2}}{2 n}}-\sum_{r=0}^{2} e^{-\frac{r^{2}}{2 n}}-\sum_{r=\left[n^{0.6}\right]+1}^{\infty} e^{-\frac{r^{2}}{2 n}}
	\end{aligned}
	\end{equation*} \label{S2}
	
	$\mathlarger \sum_{r=0}^{2} e^{-\frac{r^{2}}{2 n}} \rightarrow 3$ при $n \rightarrow \infty,$ а $\mathlarger \sum_{r=0}^{\infty} e^{-\frac{r^{2}}{2 n}} \sim \mathlarger \int_{r=0}^{\infty} e^{-\frac{r^{2}}{2 n}} dr$. А это известный всем нам интеграл:
	
	$$
	\begin{array}{c}
	\mathlarger{
	\int_{r=0}^{\infty} e^{-\frac{r^{2}}{2 n}} dr} =\\
	=\mathlarger{\sqrt{n} \int_{x=0}^{\infty} e^{-\frac{z^{2}}{2}} dx} \\
	=\sqrt{n} \frac{\sqrt{2\pi}}{2}=\sqrt{\frac{\pi n}{2}} \\
	\end{array} \label{integral}
	$$
	
	Осталось оценить последнюю из сумм.
	
	$$
	\sum_{r=\left[n^{0.6}\right]+1} e^{-\frac{r^{2}}{2 n}}=\underbrace{\sum_{r=\left[n^{0.6}\right]+1}^{n^{2}} e^{-\frac{r^{2}}{2 n}}}_{S_1^{\prime}} + \underbrace{\sum_{n^{2}+1}^{\infty} e^{-\frac{r^{2}}{2 n}}}_{S_{2}^{\prime}}
	$$
	
	Оценим $S_1^{\prime}$. Аналогично  \ref{S2}, $\mathlarger{S_{1}^{\prime} \leqslant \sum_{r=\left[n^{0.6}\right]+1}^{n^{2}} e^{-\frac{n^{1,2}}{2 n}}<n^{2} e^{-\frac{n^{0,2}}{2}} \rightarrow 0}$. Теперь оценим  $S_{2}^{\prime}$. Заметим, что
	отношение двух соседних слагаемых в $S_{2}^{\prime}$ не превосходит $e^{-n}$. Действительно,
	
	$$ \mathlarger{
	e^{-\frac{(r+1)^{2}-r^{2}}{2 n}}=e^{-\frac{2 r-1}{2 n}}<e^{-\frac{r}{n}}<e^{-n}}
	$$
	
	В таком случае можем оценить $S_{2}^{\prime}$ суммой геометрической прогрессии со знаменателем $e^{-n}$ и первым членом, равным  $e^{-\frac{(n^{2}+1)^{2}}{2 n}}$:
	
	$$
	\mathlarger{ S_{2}^{\prime} < e^{-\frac{(n^{2}+1)^{2}}{2 n}}\left(1+e^{-n}+e^{-2 n}+\ldots\right)= e^{ -\frac{\left(n^{2}+1\right)^{2}}{2 n}} \cdot \frac{1}{1-e^{-n}} \rightarrow 0}
	$$
	
	Итого:
	$$
	U(n) \sim \frac{1}{2} n^{n-1}\left(S_{1}+S_{2}\right) \sim \frac{1}{2} n^{n-1} \sqrt{\frac{\pi n}{2}}=\sqrt{\frac{\pi}{8}} n^{n-\frac{1}{2}},
	$$
\end{proof}

Основной результат главы доказан. Посмотрим тепрь на асимптотику еще одной величины, но оставим ее без доказательства.

Обозначим за $C(n, k)$ количество связных графов на $n$ вершинах с k ребрами. Из очевидных соображений имеем $C(n, k) = 0$ для $k = 1, \dots n-2$. Из теоремы \ref{Caley} знаем, что $C(n, n-1) = n^{n-2}$. Из только что доказанной теоремы \ref{izvrat} $C(n, n) = U(n)$. 

\begin{theorem}[б/д]
	$$C(n, n+1) \sim \frac{5}{24}n^{n+1}$$
\end{theorem}


\subsubsection{Эйлеровы и Гамильтоновы графы}

\begin{Def}
	\emph{Эйлеров} цикл (путь) - это цикл (путь), проходящий через каждое ребро графа ровно по одному разу.
\end{Def}

\begin{Def}
	\emph{Гамильтонов} путь (цикл) - это путь (цикл), проходящий через каждую вершину (кроме начальной и последней) графа ровно по одному разу.
\end{Def}

\begin{Def}
	Граф называется \emph{гамильтоновым}, если существует несамопересекающийся цикл, проходящий по каждой (кроме начальной и последней) вершине ровно по одному разу.
\end{Def}

Есть способы достаточно быстро проверить, вяляется ли граф эйлеровым. А именно, верна следующая теорема:

\begin{theorem}
	Для связного графа следующие утверждения эквивалентны:
	\begin{enumerate}
		\item Граф эйлеров
		\item Степень каждой вершины четна
		\item Множество ребер графа распадается в объединение непересекающихся по ребрам простых циклов
	\end{enumerate}
\end{theorem}

\begin{proof}
	
	$1 \Rightarrow 2$.
	Если у какой-то вершины степень нечетна, то существует минимум две вершины $v_1$ и $v_2$ с нечетной степенью. Раз так, то наш эйлеров путь начался в $v_1$ и закончился в $v_2$ или наоборот, но он является циклом.
	 
	$2 \Rightarrow 3$.
	Будем идти по графу из произвольной вершины $v$. Поскольку степень каждой вершины четна, мы, войдя в очередную вершину, сможем выйти из нее. будем продолжать движение, пока не вернемся в одну из уже выбранных вершин. Тогда мы найдем некоторый простой цикл.
	Удалим все его ребра из $G$ и получим новый граф, возможно, с несколькими компонентами связности.
	Проделаем аналогичную операцию в остальных компонентах и заметим при этом, что количество ребер ф графе уменьшается, а свойство четности степеней вершин сохраняется.
	
	$3 \Rightarrow 1$.
	Доказательство по индукции. Для одного простого цикла утверждение очевидно.
	Возьмем произвольный граф и удалим один простой цикл $Z$. Полученный граф $G^{\prime}$ распадется на компоненты связности, в каждой из который есть эйлеров цикл по предположению индукции. Начнем обходить граф по исходному циклу $Z$. Попадая на очередном шаге в вершину в одной из компонент связности, обходим все ребра компоненты связности, возввращаясь в иходную вершину цикла $Z$. Таким образом мы обойдем весь граф.
\end{proof}

Задача проверки Гамильтоновости графа является $NP$-полной, т.е. неизвестен алгоритм, который бы в общем случае за полиномиальное время смог проверить, является ли произвольный граф гамильтоновым.
Тем не менее, в частных случаях есть множество способов понять, является ли граф гамильтоновым. 
Сформулируем два признака.

\begin{theorem}(Признак Дирака)
	Пусть $G = (V, E), |V| = n$. Пусть $\forall v \in V deg(v) \geqslant \frac{n}{2}$. Тогда граф Гамильтонов.
\end{theorem}

\begin{Def}
	Подмножество $W \subseteq G$ называется \emph{независимым}, если $\forall x, y \in W : (x, y) \notin E$. 
\end{Def}

\begin{Def}
	$\alpha(G) = \max \left\lbrace k \in \mathbb{N} \mid \exists W \subset G : \forall x, y \in W  (x, y) \notin E \land |W| = k  \right\rbrace$ - \emph{число независимости} графа. Другими словами, это самый большой размер множества вершин графа $ G $, в котором нет ни одного ребра.
	В частности, $\omega(G)$ обозначается одно из максимальных независимых множеств графа.
\end{Def}

\begin{Def}
	$\varkappa(G) = \min \left\lbrace k \in \mathbb{N} \mid \exists W \subset G : |W| = k \land G|_{V\setminus E} - \text{несвязен} \right\rbrace$ - \emph{вершинная связность} графа. Другими словами, это минимальное количество вершин, удаление которых делает граф несвязным.
\end{Def}
